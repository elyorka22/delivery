# Проверка ошибки 500 на Railway

## Проблема
Ошибка 500 (Internal Server Error) означает, что на сервере произошла внутренняя ошибка.

---

## Как проверить логи Railway

### Шаг 1: Открыть логи

1. Зайдите на https://railway.app
2. Откройте ваш проект → сервис (backend)
3. Перейдите в **Deployments** → последний деплой
4. Откройте **Logs** (Логи)

### Шаг 2: Найти ошибку

В логах ищите:
- `Error:` или `ERROR:`
- `Failed to`
- `Cannot`
- Стек ошибок (stack trace)

---

## Возможные причины ошибки 500

### 1. Проблема с подключением к базе данных

**Признаки:**
- `Can't reach database server`
- `Connection refused`
- `P1001` или другие Prisma ошибки

**Решение:**
- Проверьте переменную `DATABASE_URL` в Railway
- Убедитесь, что Supabase проект активен
- Проверьте пароль (может быть неправильно URL-encoded)

### 2. Проблема с CORS кодом

**Признаки:**
- `TypeError: callback is not a function`
- Ошибки связанные с `cors`

**Решение:**
- Проверьте код CORS в `backend/src/index.ts`
- Убедитесь, что синтаксис правильный

### 3. Проблема с переменными окружения

**Признаки:**
- `JWT_SECRET is not defined`
- `FRONTEND_URL is not defined`

**Решение:**
- Проверьте все переменные окружения в Railway
- Убедитесь, что они правильно настроены

### 4. Проблема с Prisma

**Признаки:**
- `PrismaClientInitializationError`
- `Schema validation error`

**Решение:**
- Проверьте подключение к базе данных
- Убедитесь, что миграции применены

---

## Что проверить в Railway

### Переменные окружения

1. **Settings** → **Variables**
2. Проверьте наличие всех переменных:
   - `DATABASE_URL`
   - `JWT_SECRET`
   - `FRONTEND_URL`
   - `NODE_ENV`

### Логи сервера

1. **Deployments** → последний деплой → **Logs**
2. Ищите ошибки при запуске сервера
3. Проверьте, запустился ли сервер: `Server is running on port 8080`

---

## Быстрое решение

### Если проблема с CORS

Проверьте код в `backend/src/index.ts` - возможно, есть синтаксическая ошибка в CORS конфигурации.

### Если проблема с базой данных

1. Проверьте `DATABASE_URL` в Railway
2. Убедитесь, что Supabase проект активен
3. Попробуйте перезапустить сервер в Railway

---

## После исправления

1. Railway автоматически перезапустит сервер
2. Проверьте логи снова
3. Попробуйте войти снова

---

## Если не можете найти ошибку

Скопируйте последние строки из логов Railway и отправьте их - помогу разобраться.

